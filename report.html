<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø°ÙƒÙŠØ© | Ù†Ø¸Ø§Ù… ØªÙ‚ÙŠÙŠÙ… Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ø¯Ø§Ø±Ø³</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
  margin:0;
  font-family:Tahoma, Arial;
  background:#f4f6f9;
}

header{
  background:#1f3c88;
  color:#fff;
  padding:20px 30px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

header h2{margin:0}

.container{
  padding:30px;
}

.summary{
  display:grid;
  grid-template-columns: repeat(auto-fit,minmax(220px,1fr));
  gap:20px;
  margin-bottom:40px;
}

.box{
  background:#fff;
  padding:25px;
  border-radius:16px;
  text-align:center;
  box-shadow:0 10px 20px rgba(0,0,0,.08);
}

.box span{
  font-size:34px;
  color:#1f3c88;
  font-weight:bold;
}

.charts{
  display:grid;
  grid-template-columns: repeat(auto-fit,minmax(350px,1fr));
  gap:30px;
}

.card{
  background:#fff;
  padding:20px;
  border-radius:16px;
  box-shadow:0 10px 20px rgba(0,0,0,.08);
}

.back{
  background:#eee;
  color:#333;
  padding:8px 14px;
  border-radius:6px;
  text-decoration:none;
}
</style>
</head>

<body>

<header>
  <h2>ðŸ“Š Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø°ÙƒÙŠØ©</h2>
  <a href="dashboard.html" class="back">â¬… Ø±Ø¬ÙˆØ¹</a>
</header>

<div class="container">

  <!-- Ù…Ù„Ø®Øµ -->
  <div class="summary">
    <div class="box">
      <h4>Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¯Ù„Ø©</h4>
      <span id="total">0</span>
    </div>
    <div class="box">
      <h4>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆØ±</h4>
      <span id="axesCount">0</span>
    </div>
    <div class="box">
      <h4>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¬Ø§Ù„Ø§Øª</h4>
      <span id="domainsCount">0</span>
    </div>
    <div class="box">
      <h4>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ±</h4>
      <span id="standardsCount">0</span>
    </div>
  </div>

  <!-- Ø§Ù„Ø±Ø³ÙˆÙ… -->
  <div class="charts">

    <div class="card">
      <h3>Ø§Ù„Ø£Ø¯Ù„Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…Ø­ÙˆØ±</h3>
      <canvas id="axisChart"></canvas>
    </div>

    <div class="card">
      <h3>Ø§Ù„Ø£Ø¯Ù„Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…Ø¬Ø§Ù„</h3>
      <canvas id="domainChart"></canvas>
    </div>

    <div class="card">
      <h3>Ø§Ù„Ø£Ø¯Ù„Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…Ø¹ÙŠØ§Ø±</h3>
      <canvas id="standardChart"></canvas>
    </div>

  </div>

</div>

<script>
// Ø­Ù…Ø§ÙŠØ©
if(!localStorage.getItem("loggedIn")){
  window.location.href="login.html";
}

const evidences = JSON.parse(localStorage.getItem("evidences")) || [];

document.getElementById("total").innerText = evidences.length;

function countBy(key){
  const map = {};
  evidences.forEach(e=>{
    map[e[key]] = (map[e[key]] || 0) + 1;
  });
  return map;
}

const axisData = countBy("axis");
const domainData = countBy("domain");
const standardData = countBy("standard");

document.getElementById("axesCount").innerText = Object.keys(axisData).length;
document.getElementById("domainsCount").innerText = Object.keys(domainData).length;
document.getElementById("standardsCount").innerText = Object.keys(standardData).length;

// Charts
new Chart(axisChart,{
  type:'bar',
  data:{
    labels:Object.keys(axisData),
    datasets:[{
      data:Object.values(axisData),
      backgroundColor:'#1f3c88'
    }]
  }
});

new Chart(domainChart,{
  type:'doughnut',
  data:{
    labels:Object.keys(domainData),
    datasets:[{
      data:Object.values(domainData),
      backgroundColor:['#1f3c88','#2563eb','#60a5fa','#93c5fd']
    }]
  }
});

new Chart(standardChart,{
  type:'bar',
  data:{
    labels:Object.keys(standardData),
    datasets:[{
      data:Object.values(standardData),
      backgroundColor:'#2563eb'
    }]
  }
});
</script>

</body>
</html>

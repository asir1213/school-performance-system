<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ | Ù†Ø¸Ø§Ù… ØªÙ‚ÙŠÙŠÙ… Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ø¯Ø§Ø±Ø³</title>

<style>
body{
  margin:0;
  font-family:Tahoma, Arial;
  background:#f4f6f9;
}
header{
  background:#1f3c88;
  color:#fff;
  padding:20px 30px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.container{
  padding:30px;
}
.card{
  background:#fff;
  padding:25px;
  border-radius:16px;
  box-shadow:0 10px 20px rgba(0,0,0,.08);
  margin-bottom:25px;
}
.card h3{
  margin-top:0;
  color:#1f3c88;
}
.alert{
  padding:15px;
  border-radius:10px;
  margin-bottom:15px;
}
.low{background:#fee2e2;color:#991b1b}
.mid{background:#fef3c7;color:#92400e}
.good{background:#dcfce7;color:#166534}
.back{
  background:#eee;
  color:#333;
  padding:8px 14px;
  border-radius:6px;
  text-decoration:none;
}
</style>
</head>

<body>

<header>
  <h2>ğŸ¤– Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ Ù„Ù„ØªÙ‚ÙˆÙŠÙ…</h2>
  <a href="dashboard.html" class="back">â¬… Ø±Ø¬ÙˆØ¹</a>
</header>

<div class="container">

  <div class="card">
    <h3>ğŸ“Š ØªØ­Ù„ÙŠÙ„ Ø¹Ø§Ù…</h3>
    <div id="summary"></div>
  </div>

  <div class="card">
    <h3>âš ï¸ Ù…Ø¬Ø§Ù„Ø§Øª ØªØ­ØªØ§Ø¬ Ø£ÙˆÙ„ÙˆÙŠØ© ØªØ·ÙˆÙŠØ±</h3>
    <div id="weakness"></div>
  </div>

  <div class="card">
    <h3>âœ… ØªÙˆØµÙŠØ§Øª Ø°ÙƒÙŠØ©</h3>
    <div id="recommendations"></div>
  </div>

</div>

<script>
// Ø­Ù…Ø§ÙŠØ©
if(!localStorage.getItem("loggedIn")){
  window.location.href="login.html";
}

const evidences = JSON.parse(localStorage.getItem("evidences")) || [];

function countBy(key){
  const map = {};
  evidences.forEach(e=>{
    map[e[key]] = (map[e[key]] || 0) + 1;
  });
  return map;
}

const axisData = countBy("axis");
const domainData = countBy("domain");

const summary = document.getElementById("summary");
const weakness = document.getElementById("weakness");
const rec = document.getElementById("recommendations");

summary.innerHTML = `
<p>Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„ÙƒÙ„ÙŠ: <strong>${evidences.length}</strong></p>
<p>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆØ± Ø§Ù„Ù…ÙˆØ«Ù‚Ø©: <strong>${Object.keys(axisData).length}</strong></p>
<p>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¬Ø§Ù„Ø§Øª Ø§Ù„Ù…ÙˆØ«Ù‚Ø©: <strong>${Object.keys(domainData).length}</strong></p>
`;

Object.keys(domainData).forEach(domain=>{
  if(domainData[domain] <= 1){
    weakness.innerHTML += `
      <div class="alert low">
        ğŸ”´ Ø¶Ø¹Ù ÙÙŠ ØªÙˆØ«ÙŠÙ‚ Ù…Ø¬Ø§Ù„ <strong>${domain}</strong>
      </div>
    `;
  } else if(domainData[domain] <= 3){
    weakness.innerHTML += `
      <div class="alert mid">
        ğŸŸ¡ ØªÙˆØ«ÙŠÙ‚ Ù…ØªÙˆØ³Ø· ÙÙŠ Ù…Ø¬Ø§Ù„ <strong>${domain}</strong>
      </div>
    `;
  }
});

if(weakness.innerHTML===""){
  weakness.innerHTML = `
    <div class="alert good">
      ğŸŸ¢ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¬Ø§Ù„Ø§Øª Ù…ÙˆØ«Ù‚Ø© Ø¨Ø´ÙƒÙ„ Ø¬ÙŠØ¯
    </div>
  `;
}

rec.innerHTML = `
<ul>
  <li>ØªØ¹Ø²ÙŠØ² ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ù…Ø¬Ø§Ù„Ø§Øª Ø°Ø§Øª Ø§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„Ù…Ø­Ø¯ÙˆØ¯Ø©.</li>
  <li>ØªÙ†ÙˆÙŠØ¹ Ø§Ù„Ø£Ø¯Ù„Ø© Ø¨ÙŠÙ† ØªØ®Ø·ÙŠØ·ØŒ ØªÙ†ÙÙŠØ°ØŒ ÙˆØªÙ‚ÙˆÙŠÙ….</li>
  <li>Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø±ÙØ¹ Ø£Ø¯Ù„Ø© Ù†ÙˆØ¹ÙŠØ© ØªØ¹ÙƒØ³ Ø§Ù„Ø£Ø«Ø± Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ.</li>
  <li>Ø§Ù„Ø§Ø³ØªÙØ§Ø¯Ø© Ù…Ù† Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙÙŠ Ø¥Ø¹Ø¯Ø§Ø¯ Ø®Ø·Ø© ØªØ­Ø³ÙŠÙ†.</li>
</ul>
`;
</script>

</body>
</html>
